{"ast":null,"code":"var _jsxFileName = \"/home/anonymous/PharmaBuddy/src/components/sellMed.jsx\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport { useRef, useState, useEffect } from \"react\";\nimport userStore from \"../stores/userStore\";\nimport { Navigate } from \"react-router-dom\";\nimport { getDoc, setDoc, doc } from \"firebase/firestore\";\nimport db from \"../firebase\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction SellMed() {\n  _s();\n\n  const user = userStore.getState().user;\n  const [tokenAdd, setTokenAdd] = useState(false);\n  useEffect(() => {\n    if (!user.uid) return;\n\n    if (parseInt(quantityRef.current.value) < 1) {\n      alert(\"Invalid Quanity\");\n      return;\n    }\n\n    const code = async () => {\n      const ref = doc(db, \"Pharma\", user.uid);\n      const docSnap = await getDoc(ref);\n      var data = docSnap.data();\n      var oldmeds = data.meds;\n\n      if (tokenAdd) {\n        try {\n          var found = false;\n\n          for (var i = 0; i < oldmeds.length; i++) {\n            if (oldmeds[i].name === nameRef.current.value) {\n              if (oldmeds[i].quantity < parseInt(quantityRef.current.value)) {\n                alert(\"Insuffcient Stock\");\n                return;\n              }\n\n              oldmeds[i].quantity -= parseInt(quantityRef.current.value);\n              found = true;\n              break;\n            }\n          }\n\n          if (!found) {\n            alert(\"Med not found\");\n          }\n\n          data.meds = oldmeds;\n          await setDoc(ref, data);\n        } catch (e) {\n          alert(e.message);\n        }\n      }\n    };\n\n    code();\n    setTokenAdd(false);\n  }, [tokenAdd, user.uid]);\n  const nameRef = useRef(null);\n  const quantityRef = useRef(null);\n  if (!user) return /*#__PURE__*/_jsxDEV(Navigate, {\n    to: \"/\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 51,\n    columnNumber: 21\n  }, this);\n\n  const handleAdd = e => {\n    e.preventDefault();\n    setTokenAdd(true);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      action: \"\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        class: \"btn\",\n        type: \"text\",\n        placeholder: \"Med Name\",\n        ref: nameRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        class: \"btn\",\n        type: \"text\",\n        placeholder: \"quantity\",\n        ref: quantityRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        class: \"btn selected btn-fluid2\",\n        type: \"button\",\n        value: \"Sell Stock\",\n        onClick: handleAdd\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 5\n  }, this);\n}\n\n_s(SellMed, \"qgamqwthNBWF97CLgDWJ29sf1/0=\");\n\n_c = SellMed;\nexport default SellMed;\n\nvar _c;\n\n$RefreshReg$(_c, \"SellMed\");","map":{"version":3,"sources":["/home/anonymous/PharmaBuddy/src/components/sellMed.jsx"],"names":["React","useRef","useState","useEffect","userStore","Navigate","getDoc","setDoc","doc","db","SellMed","user","getState","tokenAdd","setTokenAdd","uid","parseInt","quantityRef","current","value","alert","code","ref","docSnap","data","oldmeds","meds","found","i","length","name","nameRef","quantity","e","message","handleAdd","preventDefault"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { useRef, useState, useEffect } from \"react\";\nimport userStore from \"../stores/userStore\";\nimport { Navigate } from \"react-router-dom\";\nimport { getDoc, setDoc, doc } from \"firebase/firestore\";\nimport db from \"../firebase\";\n\nfunction SellMed() {\n  const user = userStore.getState().user;\n  const [tokenAdd, setTokenAdd] = useState(false);\n  useEffect(() => {\n    if (!user.uid) return;\n    if (parseInt(quantityRef.current.value) < 1) {\n      alert(\"Invalid Quanity\");\n      return;\n    }\n    const code = async () => {\n      const ref = doc(db, \"Pharma\", user.uid);\n      const docSnap = await getDoc(ref);\n      var data = docSnap.data();\n      var oldmeds = data.meds;\n      if (tokenAdd) {\n        try {\n          var found = false;\n          for (var i = 0; i < oldmeds.length; i++) {\n            if (oldmeds[i].name === nameRef.current.value) {\n              if (oldmeds[i].quantity < parseInt(quantityRef.current.value)) {\n                alert(\"Insuffcient Stock\");\n                return;\n              }\n              oldmeds[i].quantity -= parseInt(quantityRef.current.value);\n              found = true;\n              break;\n            }\n          }\n          if (!found) {\n            alert(\"Med not found\");\n          }\n          data.meds = oldmeds;\n          await setDoc(ref, data);\n        } catch (e) {\n          alert(e.message);\n        }\n      }\n    };\n    code();\n    setTokenAdd(false);\n  }, [tokenAdd, user.uid]);\n  const nameRef = useRef(null);\n  const quantityRef = useRef(null);\n  if (!user) return <Navigate to=\"/\" />;\n  const handleAdd = (e) => {\n    e.preventDefault();\n    setTokenAdd(true);\n  };\n  return (\n    <div className=\"container\">\n      <form action=\"\">\n        <input class=\"btn\" type=\"text\" placeholder=\"Med Name\" ref={nameRef} />\n        <input\n          class=\"btn\"\n          type=\"text\"\n          placeholder=\"quantity\"\n          ref={quantityRef}\n        />\n        <br />\n        <br />\n        <input\n          class=\"btn selected btn-fluid2\"\n          type=\"button\"\n          value=\"Sell Stock\"\n          onClick={handleAdd}\n        />\n      </form>\n    </div>\n  );\n}\n\nexport default SellMed;\n"]},"metadata":{},"sourceType":"module"}